<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f1923">
    <title>Valorant Manager 2026</title>
    <style>
        :root {
            --bg: #0f1923;
            --text: #ece8e1;
            --red: #ff4655;
            --dark-panel: #1f2731;
            --border: #535c68;
            --duelist: #f39c12; /* –ñ–µ–ª—Ç—ã–π/–û—Ä–∞–Ω–∂–µ–≤—ã–π */
            --controller: #8e44ad; /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π */
            --sentinel: #16a085; /* –¶–∏–∞–Ω */
            --initiator: #2980b9; /* –°–∏–Ω–∏–π */
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* --- UI COMPONENTS --- */
        h2 { color: var(--red); text-transform: uppercase; margin: 0 0 15px 0; letter-spacing: 2px; }
        
        /* –ü–°–ò–•–£–®–ö–ê MODE */
        .mode-switch-container {
            display: flex; align-items: center; margin-bottom: 20px;
            background: var(--dark-panel); padding: 8px 15px; border-radius: 50px;
            border: 1px solid var(--border);
        }
        .switch-label { font-weight: bold; font-size: 14px; margin-left: 10px; text-transform: uppercase;}
        .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--border); transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--red); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* –ö–û–õ–ï–°–û */
        .wheel-container { position: relative; width: 260px; height: 260px; margin: 10px 0; filter: drop-shadow(0 0 10px rgba(0,0,0,0.5)); }
        canvas { width: 100%; height: 100%; transform: rotate(-90deg); transition: transform 4s cubic-bezier(0.1, 0.7, 0.1, 1); }
        .arrow { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid #ece8e1; z-index: 10; }

        /* –°–ü–ò–°–û–ö –ò–ì–†–û–ö–û–í */
        .roster-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; width: 100%; max-width: 400px; margin-bottom: 10px; }
        .player-checkbox { display: none; }
        .player-label {
            background: var(--dark-panel); border: 1px solid var(--border); padding: 10px 2px;
            text-align: center; border-radius: 4px; cursor: pointer; font-size: 13px;
            transition: 0.2s; user-select: none; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .player-checkbox:checked + .player-label { background: var(--red); color: white; border-color: var(--red); font-weight: bold; }
        .add-btn { background: #16a085; color: white; border: 1px dashed #fff; font-size: 20px; display: flex; justify-content: center; align-items: center; cursor: pointer; border-radius: 4px; }

        /* MAIN BUTTONS */
        .btn {
            background: linear-gradient(45deg, var(--red), #d63c4b); color: white; border: none;
            padding: 15px 0; width: 100%; max-width: 400px; font-size: 18px; font-weight: bold;
            border-radius: 4px; cursor: pointer; text-transform: uppercase; margin-top: 10px;
            box-shadow: 0 4px 0 #9e1c28; transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn:active { transform: translateY(4px); box-shadow: none; }
        
        .btn-settings {
            background: transparent; border: 1px solid var(--border); color: #8b9bb4;
            padding: 10px; width: 100%; max-width: 400px; margin-top: 20px; cursor: pointer;
            text-transform: uppercase; font-size: 12px; letter-spacing: 1px; display: flex; justify-content: space-between; align-items: center;
        }

        /* --- ADVANCED SETTINGS PANEL --- */
        .settings-panel {
            display: none; width: 90%; max-width: 380px; background: #182029;
            border: 1px solid var(--border); border-top: none; padding: 15px;
            box-sizing: border-box; animation: slideDown 0.3s ease;
        }
        @keyframes slideDown { from {opacity: 0; transform: translateY(-10px);} to {opacity: 1; transform: translateY(0);} }

        .section-title { color: #8b9bb4; font-size: 12px; text-transform: uppercase; margin-top: 15px; border-bottom: 1px solid var(--border); padding-bottom: 5px; margin-bottom: 10px; }
        
        /* Dropdown */
        select { width: 100%; padding: 10px; background: var(--dark-panel); color: white; border: 1px solid var(--border); border-radius: 4px; outline: none; }

        /* Checkbox Grids */
        .check-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px; }
        .check-grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; }
        
        .mini-label { display: flex; align-items: center; font-size: 12px; cursor: pointer; color: #ccc; }
        .mini-label input { margin-right: 5px; accent-color: var(--red); }

        /* –ê–ì–ï–ù–¢–´ (–¶–≤–µ—Ç–Ω—ã–µ —Ä–∞–º–∫–∏) */
        .agent-label { font-size: 11px; padding: 5px; border-radius: 3px; background: #2a353f; border-left: 3px solid #555; display: flex; align-items: center; }
        .role-duelist { border-left-color: var(--duelist); }
        .role-controller { border-left-color: var(--controller); }
        .role-sentinel { border-left-color: var(--sentinel); }
        .role-initiator { border-left-color: var(--initiator); }

        /* --- RESULT BOX --- */
        .result-box {
            margin-top: 20px; padding: 20px; background: var(--dark-panel); border-left: 5px solid var(--red);
            width: 90%; max-width: 400px; display: none; text-align: left; margin-bottom: 50px;
        }
        .mode-badge { font-size: 12px; background: #333; padding: 2px 6px; border-radius: 4px; color: #aaa; text-transform: uppercase; margin-bottom: 5px; display: inline-block;}
        .map-display { font-size: 26px; font-weight: bold; margin-bottom: 10px; color: var(--text); }
        .team-header { color: var(--red); font-weight: bold; margin-top: 15px; border-bottom: 1px solid var(--border); font-size: 14px; }
        .player-row { margin-top: 5px; font-size: 15px; }
        .agent-name { font-size: 12px; color: #8b9bb4; margin-left: 5px; font-style: italic; }
        .crown { color: gold; margin-right: 5px; }
    </style>
</head>
<body>

    <h2>VALORANT 2026</h2>

    <div class="mode-switch-container">
        <label class="switch">
            <input type="checkbox" id="psychoMode" checked onchange="toggleMode()">
            <span class="slider"></span>
        </label>
        <span class="switch-label">Squad: –ü—Å–∏—Ö—É—à–∫–∞</span>
    </div>

    <div class="wheel-container">
        <div class="arrow"></div>
        <canvas id="wheelCanvas" width="500" height="500"></canvas>
    </div>
    
    <div id="playerCounter" style="color: #8b9bb4; font-size: 14px; margin-bottom: 10px;">0 Players</div>

    <div class="roster-grid" id="rosterArea"></div>

    <button class="btn" onclick="spinWheel()">LOCK IN & START</button>

    <button class="btn-settings" onclick="toggleSettings()">
        <span>‚öôÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</span>
        <span id="settingsArrow">‚ñº</span>
    </button>

    <div class="settings-panel" id="settingsPanel">
        
        <div class="section-title">–ò–≥—Ä–æ–≤–æ–π —Ä–µ–∂–∏–º</div>
        <select id="gameMode">
            <option value="Unrated">Unrated (Standard)</option>
            <option value="Competitive">Competitive (Ranked)</option>
            <option value="Team Deathmatch">Team Deathmatch (TDM)</option>
            <option value="Deathmatch">Deathmatch</option>
            <option value="Spike Rush">Spike Rush</option>
            <option value="Escalation">Escalation</option>
        </select>

        <div class="section-title">–ü—É–ª –∫–∞—Ä—Ç <span style="float:right; cursor:pointer;" onclick="toggleAll('map')">[All]</span></div>
        <div class="check-grid" id="mapsGrid"></div>

        <div class="section-title" style="display:flex; justify-content:space-between; align-items:center;">
            <span>–ê–≥–µ–Ω—Ç—ã (Random Pick)</span>
            <label class="switch" style="width:30px; height:16px;">
                <input type="checkbox" id="enableAgents">
                <span class="slider"></span>
            </label>
        </div>
        <div style="font-size: 11px; color: #666; margin-bottom: 5px;">*–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç 1 –°–º–æ–∫–µ—Ä–∞ –∏ 1 –î—É—ç–ª—è–Ω—Ç–∞</div>
        <div class="check-grid-3" id="agentsGrid"></div>
    </div>

    <div class="result-box" id="result">
        <div class="mode-badge" id="resMode">Unrated</div>
        <div class="map-display" id="resMap">MAP NAME</div>
        
        <div class="team-header">TEAM A (Attack)</div>
        <div id="resTeamA"></div>

        <div class="team-header">TEAM B (Defense)</div>
        <div id="resTeamB"></div>
    </div>

    <script>
        // --- –î–ê–ù–ù–´–ï 2026 ---
        const friends = ["–í–ª–∞–¥", "–ù–∏–∫–∏—Ç–∞", "–î–∏–∞–Ω–∞", "–í–∞—Å–∏–ª–∏—Å–∞", "–í–æ–≤–∞", "–ë–æ–≥–¥–∞–Ω", "–ê—Ä—Ç–µ–º –î–æ–Ω–±–∞—Å—Å", "–ê—Ä—Ç—ë–º —Ä—ã–±–∞–∫", "Ivy"];
        let customPlayers = [];

        // –ö–∞—Ä—Ç—ã
        const mapsData = {
            std: ["Bind", "Haven", "Split", "Ascent", "Icebox", "Breeze", "Fracture", "Pearl", "Lotus", "Sunset", "Abyss", "Corrode"],
            tdm: ["District", "Kasbah", "Piazza", "Drift", "Glitch"]
        };

        // –ê–≥–µ–Ω—Ç—ã –ø–æ —Ä–æ–ª—è–º
        const agentsData = {
            duelists: ["Jett", "Reyna", "Raze", "Phoenix", "Yoru", "Neon", "ISO", "Clove", "Waylay", "Tejo"],
            controllers: ["Brimstone", "Omen", "Viper", "Astra", "Harbor"], // –°–º–æ–∫–µ—Ä—ã
            initiators: ["Sova", "Breach", "Skye", "KAY/O", "Fade", "Gekko"],
            sentinels: ["Sage", "Cypher", "Killjoy", "Chamber", "Deadlock", "Vyse", "Veto"]
        };

        const canvas = document.getElementById("wheelCanvas");
        const ctx = canvas.getContext("2d");
        const colors = ["#ff4655", "#0f1923", "#535c68", "#2c3e50", "#c0392b", "#8e44ad", "#2980b9", "#16a085"];
        let currentRotation = 0;

        // --- INIT ---
        function init() {
            renderRoster();
            
            // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç
            const mapContainer = document.getElementById("mapsGrid");
            // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ
            mapsData.std.forEach(m => addCheck(mapContainer, m, "map-check", true, "‚≠ê " + m));
            // TDM
            mapsData.tdm.forEach(m => addCheck(mapContainer, m, "map-check", true, "üÜï " + m));

            // –†–µ–Ω–¥–µ—Ä –∞–≥–µ–Ω—Ç–æ–≤
            const agentContainer = document.getElementById("agentsGrid");
            const addAgent = (list, roleClass) => {
                list.forEach(a => {
                    agentContainer.innerHTML += `
                        <label class="mini-label agent-label ${roleClass}">
                            <input type="checkbox" class="agent-check" value="${a}" data-role="${roleClass}" checked> ${a}
                        </label>`;
                });
            };
            addAgent(agentsData.duelists, "role-duelist");
            addAgent(agentsData.controllers, "role-controller");
            addAgent(agentsData.initiators, "role-initiator");
            addAgent(agentsData.sentinels, "role-sentinel");

            drawWheel([]);
        }

        function addCheck(container, value, cls, checked, labelText) {
            container.innerHTML += `
                <label class="mini-label">
                    <input type="checkbox" class="${cls}" value="${value}" ${checked ? 'checked' : ''}> ${labelText}
                </label>`;
        }

        // --- –õ–û–ì–ò–ö–ê UI ---
        function toggleSettings() {
            const panel = document.getElementById("settingsPanel");
            const arrow = document.getElementById("settingsArrow");
            if (panel.style.display === "block") {
                panel.style.display = "none";
                arrow.innerText = "‚ñº";
            } else {
                panel.style.display = "block";
                arrow.innerText = "‚ñ≤";
                // –°–∫—Ä–æ–ª–ª –≤–Ω–∏–∑ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
                panel.scrollIntoView({behavior: "smooth"});
            }
        }

        function toggleAll(type) {
            const cls = type === 'map' ? '.map-check' : '.agent-check';
            const boxes = document.querySelectorAll(cls);
            const newState = !boxes[0].checked;
            boxes.forEach(b => b.checked = newState);
        }

        function toggleMode() {
            customPlayers = [];
            renderRoster();
            updateUI();
        }

        function renderRoster() {
            const isPsycho = document.getElementById('psychoMode').checked;
            const rosterDiv = document.getElementById("rosterArea");
            rosterDiv.innerHTML = '';

            if (isPsycho) {
                friends.forEach((name, i) => {
                    rosterDiv.innerHTML += `
                        <input type="checkbox" class="player-checkbox" id="f_${i}" value="${name}" onchange="updateUI()">
                        <label class="player-label" for="f_${i}">${name}</label>`;
                });
            }
            customPlayers.forEach((name, i) => {
                rosterDiv.innerHTML += `
                    <input type="checkbox" class="player-checkbox" id="c_${i}" value="${name}" checked onchange="updateUI()">
                    <label class="player-label" for="c_${i}">${name}</label>`;
            });

            const plusBtn = document.createElement('div');
            plusBtn.className = 'add-btn';
            plusBtn.innerHTML = '+';
            plusBtn.onclick = () => {
                const name = prompt("–ò–º—è –∏–≥—Ä–æ–∫–∞:");
                if (name && name.trim()) {
                    customPlayers.push(name.trim());
                    renderRoster();
                    updateUI();
                }
            };
            rosterDiv.appendChild(plusBtn);
        }

        function updateUI() {
            const selected = Array.from(document.querySelectorAll('.player-checkbox:checked')).map(c => c.value);
            const count = selected.length;
            let modeText = count >= 2 ? `(${Math.floor(count/2)} vs ${Math.ceil(count/2)})` : "(–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)";
            document.getElementById("playerCounter").innerText = `${count} Players ${modeText}`;
            drawWheel(selected);
        }

        // --- SMART AGENT PICKER ---
        function assignAgents(teamSize) {
            // –°–æ–±–∏—Ä–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
            const getAvail = (cls) => Array.from(document.querySelectorAll(`.agent-check.${cls}:checked`)).map(c => c.value);
            
            let poolDuelists = getAvail('role-duelist');
            let poolControllers = getAvail('role-controller');
            let poolOthers = [...getAvail('role-sentinel'), ...getAvail('role-initiator')];
            
            // –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω —Ä–∞–Ω–¥–æ–º–∞–π–∑–µ—Ä
            if (!document.getElementById("enableAgents").checked) return Array(teamSize).fill(null);

            let teamAgents = [];

            // –®–ê–ì 1: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ 1 —Å–º–æ–∫–µ—Ä
            if (poolControllers.length > 0) {
                const pick = poolControllers.splice(Math.floor(Math.random() * poolControllers.length), 1)[0];
                teamAgents.push(pick);
            }

            // –®–ê–ì 2: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ 1 –¥—É—ç–ª—è–Ω—Ç (–µ—Å–ª–∏ –º–µ—Å—Ç–æ –µ—Å—Ç—å)
            if (teamAgents.length < teamSize && poolDuelists.length > 0) {
                const pick = poolDuelists.splice(Math.floor(Math.random() * poolDuelists.length), 1)[0];
                teamAgents.push(pick);
            }

            // –®–ê–ì 3: –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–Ω–¥–æ–º–æ–º
            // –°–ª–∏–≤–∞–µ–º –æ—Å—Ç–∞—Ç–∫–∏ –≤ –æ–¥–∏–Ω –ø—É–ª
            let fullPool = [...poolDuelists, ...poolControllers, ...poolOthers];
            
            while (teamAgents.length < teamSize) {
                if (fullPool.length === 0) { teamAgents.push("???"); continue; } // –ö–æ–Ω—á–∏–ª–∏—Å—å –∞–≥–µ–Ω—Ç—ã
                const r = Math.floor(Math.random() * fullPool.length);
                teamAgents.push(fullPool[r]);
                fullPool.splice(r, 1);
            }

            // –®–ê–ì 4: –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Ä–æ–ª–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥—ã, —á—Ç–æ–±—ã —Å–º–æ–∫–µ—Ä –Ω–µ –≤—Å–µ–≥–¥–∞ –±—ã–ª —É –∫–∞–ø–∏—Ç–∞–Ω–∞
            return shuffle(teamAgents);
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- CORE LOGIC ---
        function drawWheel(names) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (names.length === 0) {
                ctx.beginPath(); ctx.arc(250, 250, 250, 0, 2*Math.PI); ctx.fillStyle="#1f2731"; ctx.fill();
                return;
            }
            const arc = (2*Math.PI)/names.length;
            names.forEach((n, i) => {
                ctx.beginPath(); ctx.fillStyle = colors[i % colors.length];
                ctx.moveTo(250, 250); ctx.arc(250, 250, 250, i*arc, (i+1)*arc); ctx.fill(); ctx.stroke();
                ctx.save(); ctx.translate(250, 250); ctx.rotate(i*arc + arc/2);
                ctx.textAlign = "right"; ctx.fillStyle = "#fff"; ctx.font = "bold 20px Arial";
                ctx.fillText(n, 230, 10); ctx.restore();
            });
        }

        function spinWheel() {
            const players = Array.from(document.querySelectorAll('.player-checkbox:checked')).map(c => c.value);
            const maps = Array.from(document.querySelectorAll('.map-check:checked')).map(c => c.value);

            if (players.length < 2) { alert("–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞!"); return; }
            if (maps.length === 0) { alert("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—ã!"); return; }

            document.getElementById("result").style.display = "none";
            currentRotation += Math.floor(3000 + Math.random() * 360);
            canvas.style.transform = `rotate(-${currentRotation}deg)`;

            setTimeout(() => { showResults(players, maps); }, 4000);
        }

        function showResults(players, maps) {
            // 1. –í—ã–±–æ—Ä –∫–∞—Ä—Ç—ã –∏ —Ä–µ–∂–∏–º–∞
            const map = maps[Math.floor(Math.random() * maps.length)];
            const mode = document.getElementById("gameMode").value;

            // 2. –î–µ–ª–∏–º –∫–æ–º–∞–Ω–¥—ã
            shuffle(players);
            const mid = Math.ceil(players.length / 2);
            const teamA_names = players.slice(0, mid);
            const teamB_names = players.slice(mid);

            // 3. –†–∞–∑–¥–∞–µ–º –∞–≥–µ–Ω—Ç–æ–≤
            const teamA_agents = assignAgents(teamA_names.length);
            const teamB_agents = assignAgents(teamB_names.length);

            // 4. –§–æ—Ä–º–∏—Ä—É–µ–º HTML
            const buildRow = (name, agent, isCap) => `
                <div class="player-row">
                    ${isCap ? '<span class="crown">üëë</span>' : ''}
                    <b>${name}</b>
                    ${agent ? `<span class="agent-name">(${agent})</span>` : ''}
                </div>`;

            document.getElementById("resMode").innerText = mode;
            document.getElementById("resMap").innerText = map.toUpperCase();
            
            document.getElementById("resTeamA").innerHTML = teamA_names.map((n, i) => buildRow(n, teamA_agents[i], i===0)).join('');
            document.getElementById("resTeamB").innerHTML = teamB_names.map((n, i) => buildRow(n, teamB_agents[i], i===0)).join('');

            const resBox = document.getElementById("result");
            resBox.style.display = "block";
            resBox.scrollIntoView({behavior: "smooth"});
        }

        init();
    </script>
</body>
</html>
